# Vercel Environment Variables Setup

Copy and paste these into your Vercel project settings.

## Frontend (apps/web) - Vercel Project Settings

**Path:** Vercel Dashboard â†’ Your Project â†’ Settings â†’ Environment Variables

```bash
# API Connection (REQUIRED)
NEXT_PUBLIC_API_URL=https://your-api-url.railway.app

# Replace 'your-api-url.railway.app' with your actual API URL from Railway/Render
```

**Important:** After adding, redeploy your frontend!

---

## Backend (apps/api) - Railway/Render Settings

### Railway Dashboard â†’ Variables

```bash
# Database (Auto-set by Railway when you add PostgreSQL)
DATABASE_URL=<auto-generated-by-railway>

# Security (REQUIRED)
JWT_SECRET=aJ+bkIS1tl16Lelm4pSSr0E9vF07FTcla4DDJrAIrRE=

# OpenAI (REQUIRED for AI features)
OPENAI_API_KEY=sk-your-openai-api-key-here

# Application URLs (REQUIRED)
CORS_ORIGIN=https://your-frontend.vercel.app
APP_URL=https://your-frontend.vercel.app

# Environment (REQUIRED)
NODE_ENV=production
PORT=3001

# Logging (OPTIONAL)
LOG_LEVEL=info

# Error Tracking (OPTIONAL)
SENTRY_DSN=https://your-sentry-dsn-here
```

---

## Where to Get API Keys

### OpenAI API Key
1. Go to: https://platform.openai.com/api-keys
2. Click "Create new secret key"
3. Copy and paste into `OPENAI_API_KEY`
4. **Cost:** Pay-per-use (~$0.002 per trip plan)

### Sentry DSN (Optional - Error Tracking)
1. Go to: https://sentry.io/
2. Create free account
3. Create new project
4. Copy DSN from Settings â†’ Client Keys
5. Paste into `SENTRY_DSN`

### JWT Secret (Already Generated)
Use the one provided above, or generate your own:
```bash
openssl rand -base64 32
```

---

## Step-by-Step Setup

### Step 1: Deploy API to Railway

1. **Go to:** https://railway.app/new
2. **Click:** "Deploy from GitHub repo"
3. **Select:** `ehudso7/PartyPilot`
4. **Add Database:**
   - Click "+ New" â†’ "Database" â†’ "Add PostgreSQL"
   - Railway auto-sets `DATABASE_URL` âœ…

5. **Add Environment Variables:**
   - Click on your service â†’ "Variables"
   - Add each variable from the "Backend" section above
   - **Important:** Update `CORS_ORIGIN` and `APP_URL` after deploying frontend!

6. **Get your API URL:**
   - Click "Settings" â†’ "Domains"
   - Copy the generated URL (e.g., `partypilot-api-production.up.railway.app`)

### Step 2: Configure Frontend on Vercel

1. **Fix 404 Error:**
   - Vercel Dashboard â†’ Settings â†’ General
   - **Root Directory:** `apps/web`
   - Click "Save"

2. **Add API URL:**
   - Settings â†’ Environment Variables
   - Add: `NEXT_PUBLIC_API_URL` = `https://your-railway-url.railway.app`
   - Select: Production, Preview, Development
   - Click "Save"

3. **Redeploy:**
   - Go to "Deployments"
   - Click "..." on latest deployment
   - Click "Redeploy"

### Step 3: Update Backend CORS

1. **Go back to Railway dashboard**
2. **Update variables:**
   - `CORS_ORIGIN` = Your Vercel frontend URL
   - `APP_URL` = Same Vercel frontend URL
3. **Railway auto-redeploys** âœ…

### âœ… Done! Test Your App

**Frontend:** https://your-app.vercel.app
**API Health:** https://your-api.railway.app/health

---

## Quick Copy-Paste Template

### For Railway (Copy All)
```
JWT_SECRET=aJ+bkIS1tl16Lelm4pSSr0E9vF07FTcla4DDJrAIrRE=
OPENAI_API_KEY=sk-YOUR-KEY-HERE
CORS_ORIGIN=https://your-frontend.vercel.app
APP_URL=https://your-frontend.vercel.app
NODE_ENV=production
PORT=3001
LOG_LEVEL=info
```

### For Vercel (Copy All)
```
NEXT_PUBLIC_API_URL=https://your-api.railway.app
```

**Remember:** Replace placeholder URLs with your actual URLs!

---

## Troubleshooting

### "Cannot connect to API"
- Check `NEXT_PUBLIC_API_URL` is set in Vercel
- Verify URL is correct (should include `https://`)
- Redeploy frontend after adding variable

### "CORS Error"
- Ensure `CORS_ORIGIN` in Railway matches Vercel URL exactly
- Include `https://` prefix
- No trailing slash

### "Database connection error"
- Check Railway PostgreSQL is running
- Verify `DATABASE_URL` is auto-set by Railway
- Check deployment logs

### "OpenAI error"
- Verify API key is valid
- Check OpenAI account has credits
- App works without OpenAI (fallback planner)

---

## Testing Your Setup

### Test API Health
```bash
curl https://your-api-url.railway.app/health
```

Should return:
```json
{"status":"ok","timestamp":"...","version":"1.0.0"}
```

### Test Frontend
1. Visit your Vercel URL
2. Should see PartyPilot homepage
3. Try creating a trip
4. Should work! ðŸŽ‰

---

Need more help? See **DEPLOYMENT_COMPLETE_GUIDE.md**
